
.. code:: python

    import simuOpt
    simuOpt.setOptions(quiet=True, optimized=True, numThreads=4)
    import simuPOP as sim
    import os, numpy as np, pandas as pd, collections as col
    import h5py
    from saegus import analyze, simulate, parameters, breed, operators, parse
    from scipy import stats
    import random
    np.set_printoptions(suppress=True, precision=3)

.. code:: python

    #tuson = sim.loadPopulation('tuson_selection.pop')
    tuson = sim.loadPopulation('artemis_tuson.pop')
    artemis = analyze.Study('demo')

Fixed Sites Converted Into Segregating Sites
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code:: python

    sim.stat(tuson, numOfSegSites=sim.ALL_AVAIL, vars=['numOfSegSites', 'segSites', 'numOfFixedSites', 'fixedSites'])
    #parameters.randomly_convert_fixed_sites(tuson, tuson.dvars().fixedSites)
    sim.stat(tuson, numOfSegSites=sim.ALL_AVAIL, vars=['numOfSegSites', 'segSites', 'numOfFixedSites', 'fixedSites'])
    sim.stat(tuson, alleleFreq=sim.ALL_AVAIL)
    sim.stat(tuson, heteroFreq=sim.ALL_AVAIL)

.. code:: python

    alleles  = np.asarray([tuple(tuson.dvars().alleleFreq[locus].keys()) for locus in range(tuson.totNumLoci())], dtype=np.int8)

.. code:: python

    alleles




.. parsed-literal::

    array([[1, 2],
           [2, 3],
           [2, 3],
           ..., 
           [1, 2],
           [1, 3],
           [1, 3]], dtype=int8)



.. code:: python

    np.save('demo_artemis_alleles.npy', alleles)
    artemis_alleles = pd.DataFrame(alleles)
    artemis_alleles.to_csv('demo_artemis_alleles.txt', sep='\t')

.. code:: python

    artemis_alleles




.. raw:: html

    <div>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>0</th>
          <th>1</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>1</th>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr>
          <th>2</th>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr>
          <th>3</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>4</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>5</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>6</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>7</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>8</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>9</th>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr>
          <th>10</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>11</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>12</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>13</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>14</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>15</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>16</th>
          <td>0</td>
          <td>1</td>
        </tr>
        <tr>
          <th>17</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>18</th>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr>
          <th>19</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>20</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>21</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>22</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>23</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>24</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>25</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>26</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>27</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>28</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>29</th>
          <td>0</td>
          <td>3</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>44415</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44416</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44417</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44418</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44419</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44420</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44421</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44422</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44423</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44424</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44425</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44426</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44427</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>44428</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44429</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>44430</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44431</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44432</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44433</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44434</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44435</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44436</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44437</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44438</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44439</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44440</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44441</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>44442</th>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <th>44443</th>
          <td>1</td>
          <td>3</td>
        </tr>
        <tr>
          <th>44444</th>
          <td>1</td>
          <td>3</td>
        </tr>
      </tbody>
    </table>
    <p>44445 rows × 2 columns</p>
    </div>



.. code:: python

    af = analyze.allele_data(tuson, alleles, range(tuson.totNumLoci()))
    af.minor_allele = np.asarray(af.minor_allele, dtype=np.int8)
    af.major_allele = np.asarray(af.major_allele, dtype=np.int8)
    af.to_csv('demo_artemis_founder_allele_frequencies.txt', sep='\t', float_format='%.4f')

.. code:: python

    af




.. raw:: html

    <div>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>minor_allele</th>
          <th>minor_frequency</th>
          <th>major_allele</th>
          <th>major_frequency</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>1</td>
          <td>0.319048</td>
          <td>2</td>
          <td>0.680952</td>
        </tr>
        <tr>
          <th>1</th>
          <td>2</td>
          <td>0.219048</td>
          <td>3</td>
          <td>0.780952</td>
        </tr>
        <tr>
          <th>2</th>
          <td>3</td>
          <td>0.061905</td>
          <td>2</td>
          <td>0.938095</td>
        </tr>
        <tr>
          <th>3</th>
          <td>1</td>
          <td>0.061905</td>
          <td>3</td>
          <td>0.938095</td>
        </tr>
        <tr>
          <th>4</th>
          <td>3</td>
          <td>0.309524</td>
          <td>1</td>
          <td>0.690476</td>
        </tr>
        <tr>
          <th>5</th>
          <td>3</td>
          <td>0.052381</td>
          <td>1</td>
          <td>0.947619</td>
        </tr>
        <tr>
          <th>6</th>
          <td>1</td>
          <td>0.204762</td>
          <td>3</td>
          <td>0.795238</td>
        </tr>
        <tr>
          <th>7</th>
          <td>1</td>
          <td>0.128571</td>
          <td>3</td>
          <td>0.871429</td>
        </tr>
        <tr>
          <th>8</th>
          <td>1</td>
          <td>0.133333</td>
          <td>3</td>
          <td>0.866667</td>
        </tr>
        <tr>
          <th>9</th>
          <td>3</td>
          <td>0.180952</td>
          <td>2</td>
          <td>0.819048</td>
        </tr>
        <tr>
          <th>10</th>
          <td>3</td>
          <td>0.461905</td>
          <td>1</td>
          <td>0.538095</td>
        </tr>
        <tr>
          <th>11</th>
          <td>1</td>
          <td>0.461905</td>
          <td>2</td>
          <td>0.538095</td>
        </tr>
        <tr>
          <th>12</th>
          <td>1</td>
          <td>0.090476</td>
          <td>3</td>
          <td>0.909524</td>
        </tr>
        <tr>
          <th>13</th>
          <td>3</td>
          <td>0.114286</td>
          <td>1</td>
          <td>0.885714</td>
        </tr>
        <tr>
          <th>14</th>
          <td>2</td>
          <td>0.004762</td>
          <td>1</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>15</th>
          <td>1</td>
          <td>0.004762</td>
          <td>3</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>16</th>
          <td>0</td>
          <td>0.004762</td>
          <td>1</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>17</th>
          <td>2</td>
          <td>0.038095</td>
          <td>1</td>
          <td>0.961905</td>
        </tr>
        <tr>
          <th>18</th>
          <td>2</td>
          <td>0.128571</td>
          <td>3</td>
          <td>0.871429</td>
        </tr>
        <tr>
          <th>19</th>
          <td>1</td>
          <td>0.004762</td>
          <td>2</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>20</th>
          <td>1</td>
          <td>0.295238</td>
          <td>3</td>
          <td>0.704762</td>
        </tr>
        <tr>
          <th>21</th>
          <td>3</td>
          <td>0.423810</td>
          <td>1</td>
          <td>0.576190</td>
        </tr>
        <tr>
          <th>22</th>
          <td>1</td>
          <td>0.214286</td>
          <td>3</td>
          <td>0.785714</td>
        </tr>
        <tr>
          <th>23</th>
          <td>1</td>
          <td>0.042857</td>
          <td>3</td>
          <td>0.957143</td>
        </tr>
        <tr>
          <th>24</th>
          <td>3</td>
          <td>0.004762</td>
          <td>1</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>25</th>
          <td>1</td>
          <td>0.309524</td>
          <td>3</td>
          <td>0.690476</td>
        </tr>
        <tr>
          <th>26</th>
          <td>1</td>
          <td>0.223810</td>
          <td>3</td>
          <td>0.776190</td>
        </tr>
        <tr>
          <th>27</th>
          <td>1</td>
          <td>0.004762</td>
          <td>3</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>28</th>
          <td>1</td>
          <td>0.104762</td>
          <td>3</td>
          <td>0.895238</td>
        </tr>
        <tr>
          <th>29</th>
          <td>0</td>
          <td>0.004762</td>
          <td>3</td>
          <td>0.995238</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>44415</th>
          <td>1</td>
          <td>0.066667</td>
          <td>3</td>
          <td>0.933333</td>
        </tr>
        <tr>
          <th>44416</th>
          <td>3</td>
          <td>0.319048</td>
          <td>1</td>
          <td>0.680952</td>
        </tr>
        <tr>
          <th>44417</th>
          <td>3</td>
          <td>0.333333</td>
          <td>1</td>
          <td>0.666667</td>
        </tr>
        <tr>
          <th>44418</th>
          <td>3</td>
          <td>0.328571</td>
          <td>1</td>
          <td>0.671429</td>
        </tr>
        <tr>
          <th>44419</th>
          <td>1</td>
          <td>0.147619</td>
          <td>3</td>
          <td>0.852381</td>
        </tr>
        <tr>
          <th>44420</th>
          <td>1</td>
          <td>0.419048</td>
          <td>3</td>
          <td>0.580952</td>
        </tr>
        <tr>
          <th>44421</th>
          <td>1</td>
          <td>0.071429</td>
          <td>3</td>
          <td>0.928571</td>
        </tr>
        <tr>
          <th>44422</th>
          <td>1</td>
          <td>0.419048</td>
          <td>3</td>
          <td>0.580952</td>
        </tr>
        <tr>
          <th>44423</th>
          <td>1</td>
          <td>0.166667</td>
          <td>3</td>
          <td>0.833333</td>
        </tr>
        <tr>
          <th>44424</th>
          <td>3</td>
          <td>0.080952</td>
          <td>1</td>
          <td>0.919048</td>
        </tr>
        <tr>
          <th>44425</th>
          <td>3</td>
          <td>0.295238</td>
          <td>1</td>
          <td>0.704762</td>
        </tr>
        <tr>
          <th>44426</th>
          <td>3</td>
          <td>0.180952</td>
          <td>1</td>
          <td>0.819048</td>
        </tr>
        <tr>
          <th>44427</th>
          <td>1</td>
          <td>0.028571</td>
          <td>2</td>
          <td>0.971429</td>
        </tr>
        <tr>
          <th>44428</th>
          <td>3</td>
          <td>0.171429</td>
          <td>1</td>
          <td>0.828571</td>
        </tr>
        <tr>
          <th>44429</th>
          <td>1</td>
          <td>0.080952</td>
          <td>2</td>
          <td>0.919048</td>
        </tr>
        <tr>
          <th>44430</th>
          <td>3</td>
          <td>0.457143</td>
          <td>1</td>
          <td>0.542857</td>
        </tr>
        <tr>
          <th>44431</th>
          <td>1</td>
          <td>0.385714</td>
          <td>3</td>
          <td>0.614286</td>
        </tr>
        <tr>
          <th>44432</th>
          <td>1</td>
          <td>0.176190</td>
          <td>3</td>
          <td>0.823810</td>
        </tr>
        <tr>
          <th>44433</th>
          <td>1</td>
          <td>0.376190</td>
          <td>3</td>
          <td>0.623810</td>
        </tr>
        <tr>
          <th>44434</th>
          <td>1</td>
          <td>0.457143</td>
          <td>3</td>
          <td>0.542857</td>
        </tr>
        <tr>
          <th>44435</th>
          <td>3</td>
          <td>0.438095</td>
          <td>1</td>
          <td>0.561905</td>
        </tr>
        <tr>
          <th>44436</th>
          <td>1</td>
          <td>0.380952</td>
          <td>3</td>
          <td>0.619048</td>
        </tr>
        <tr>
          <th>44437</th>
          <td>1</td>
          <td>0.385714</td>
          <td>3</td>
          <td>0.614286</td>
        </tr>
        <tr>
          <th>44438</th>
          <td>1</td>
          <td>0.457143</td>
          <td>3</td>
          <td>0.542857</td>
        </tr>
        <tr>
          <th>44439</th>
          <td>3</td>
          <td>0.457143</td>
          <td>1</td>
          <td>0.542857</td>
        </tr>
        <tr>
          <th>44440</th>
          <td>1</td>
          <td>0.457143</td>
          <td>3</td>
          <td>0.542857</td>
        </tr>
        <tr>
          <th>44441</th>
          <td>2</td>
          <td>0.457143</td>
          <td>1</td>
          <td>0.542857</td>
        </tr>
        <tr>
          <th>44442</th>
          <td>2</td>
          <td>0.466667</td>
          <td>1</td>
          <td>0.533333</td>
        </tr>
        <tr>
          <th>44443</th>
          <td>3</td>
          <td>0.261905</td>
          <td>1</td>
          <td>0.738095</td>
        </tr>
        <tr>
          <th>44444</th>
          <td>1</td>
          <td>0.266667</td>
          <td>3</td>
          <td>0.733333</td>
        </tr>
      </tbody>
    </table>
    <p>44445 rows × 4 columns</p>
    </div>



Running the Simulation
----------------------

The Tuson Genetic Map
^^^^^^^^^^^^^^^^^^^^^

.. code:: python

    tuson_parser = parse.TusonFounders()

.. code:: python

    recom_rates = tuson_parser.parse_recombination_rates('raw_genetic_map.txt')

.. code:: python

    recom_rates




.. parsed-literal::

    [0.0020926625899999962,
     2.2615580000007186e-05,
     0.00042822784999999361,
     0.00031254837999999729,
     0.0014689310100000075,
     0.00020776456000000111,
     0.0012046017399999975,
     0.0004001773199999992,
     0.0023329853400000022,
     0.00084844494999999573,
     0.00020627060000000697,
     0.0034117589199999989,
     0.00055784244999999898,
     1.7850339999991859e-05,
     0.0021015491200000016,
     0.0015734830000000023,
     0.0040656016799999993,
     0.00026672478000000055,
     3.0703610000002435e-05,
     0.0001470012899999995,
     3.271269999998161e-06,
     4.3016000000006823e-06,
     5.2572210000003671e-05,
     4.1393219999998899e-05,
     0.005212608379999999,
     0.00023272412999999936,
     0.0047767046199999989,
     0.0042987637000000013,
     2.5242900000002065e-05,
     2.2332239999995896e-05,
     0.0025030401100000032,
     0.00052706154999999867,
     0.001750234850000001,
     0.00018942481999999927,
     0.00069979514999999996,
     0.0046152015499999997,
     3.9796209999999333e-05,
     0.001775915640000001,
     2.8127809999999308e-05,
     8.8994119999999949e-05,
     2.3671659999999762e-05,
     6.6971000000082266e-07,
     7.4955999999992697e-06,
     1.236387000000061e-05,
     1.4115419999999324e-05,
     0.0010934556800000007,
     9.5613940000000006e-05,
     0.0030590279700000002,
     0.0023491098900000002,
     0.00012405085000000003,
     0.00076807977999999999,
     0.0023782680299999997,
     0.00015781967000000008,
     0.0026751555000000004,
     0.0038373337000000007,
     0.00015570750999999828,
     0.0010908798700000012,
     0.00010158981999999872,
     1.5145740000002129e-05,
     3.7864399999976149e-06,
     4.8863050000000908e-05,
     2.4727699999993468e-06,
     0.00027375673000000099,
     2.4959570000000486e-05,
     2.7071729999998962e-05,
     0.00073827768999999992,
     5.7955700000023036e-06,
     2.0838269999998714e-05,
     0.00023841666999999901,
     4.2526560000000214e-05,
     0.00013589956000000124,
     0.0017940750799999995,
     0.0018117708799999987,
     5.8728400000007676e-06,
     4.559180000001106e-06,
     0.0018864692599999987,
     0.00032269706000000121,
     0.0002088979199999974,
     4.2500800000000452e-05,
     4.9764590000000997e-05,
     4.0028030000001104e-05,
     0.00096613355999999981,
     1.6562439999998623e-05,
     0.0013440043800000013,
     0.00012613725000000021,
     0.0011818831200000003,
     0.00010455198999999916,
     6.2592100000014027e-06,
     2.7818799999979047e-06,
     1.8545800000024925e-06,
     9.2728999999902585e-07,
     0.00012502964999999922,
     7.4827179999998881e-05,
     2.5760000004204642e-08,
     4.883729999999975e-05,
     0.0019257503099999961,
     0.00020583271000000015,
     6.5605799999999276e-05,
     4.3865980000004081e-05,
     4.942972999999462e-05,
     0.0018049192299999994,
     4.5772080000001661e-05,
     9.664427000000142e-05,
     3.935832999999889e-05,
     1.8185190000004068e-05,
     6.0711759999994011e-05,
     1.004570000002758e-06,
     1.0174429999998402e-05,
     6.859373000000169e-05,
     1.4862410000002767e-05,
     0.00096899270000000209,
     3.116719999995965e-06,
     3.6035539999996754e-05,
     2.0864000000031523e-06,
     0.0066364627699999979,
     0.001095825420000005,
     1.0406259999995449e-05,
     1.7232150000001668e-05,
     1.5660899999998534e-05,
     1.7257900000045011e-06,
     6.6970999999416138e-07,
     1.9782200000002526e-05,
     0.00057983983000000185,
     0.0025070583599999985,
     0.0013449831899999952,
     0.00017819431000000387,
     9.8267019999997982e-05,
     0.0033263451800000076,
     5.7749579999990532e-05,
     0.00040950174000000674,
     0.00010916268999999979,
     0.0027242761299999963,
     0.0010955163199999963,
     0.00049692462000000331,
     0.00074461418000000275,
     4.8941000000191079e-07,
     0.0016875139599999934,
     4.4200840000003796e-05,
     0.0012687650700000041,
     0.0024165960399999964,
     1.2106289999991305e-05,
     1.6897290000015275e-05,
     0.0038767177799999874,
     1.3007820000012771e-05,
     0.0001055050399999935,
     3.2068800000004669e-05,
     5.5894999999939187e-06,
     2.258981999999854e-05,
     0.0027111910400000028,
     1.6176059999990499e-05,
     0.0010899010600000025,
     9.7881000000299417e-07,
     0.00016026669000000383,
     2.8127810000002639e-05,
     9.8910999999990421e-06,
     4.3787999999267412e-07,
     0.0058528766400000086,
     2.3955000000004388e-05,
     0.00021353436999999254,
     0.0023209820899999923,
     0.0039791833700000105,
     0.002049981470000004,
     4.9713099999859621e-06,
     8.7577400000160566e-06,
     3.2197599999861381e-06,
     0.00026886269000001126,
     0.00026332471999999105,
     0.001060150489999998,
     0.0012734530499999952,
     0.0026167877200000155,
     1.143657999998382e-05,
     0.0028948975700000012,
     0.001936749010000014,
     9.2600249999996725e-05,
     0.0002125813199999982,
     1.3394199999972045e-06,
     4.8940000000996516e-07,
     0.00020516299999998822,
     3.9564389999995341e-05,
     0.0015296685300000058,
     0.0098910459800000076,
     5.7543500000001303e-05,
     1.8726099999994972e-05,
     7.212299999999061e-06,
     5.102669999999421e-05,
     3.8895000000138682e-06,
     1.5449999999361807e-07,
     5.6410999999911833e-06,
     5.4504000000008543e-05,
     5.6153000000058736e-06,
     0.00042274139999999962,
     7.2251300000001346e-05,
     9.5819999999946509e-06,
     0.00034770820000000312,
     5.4066199999986963e-05,
     0.00014749059999999759,
     0.00010741120000000493,
     0.0045804797000000086,
     0.00019550369999999262,
     0.0026823934999999997,
     0.00029060250000000564,
     1.5969999999931872e-06,
     1.545480000000765e-05,
     0.0059108838000000042,
     0.00012260839999999717,
     0.001420093799999993,
     4.0826500000008538e-05,
     8.242579999999222e-05,
     3.4258200000003568e-05,
     2.2152000000001949e-05,
     4.7394999999994521e-06,
     0.0001560422999999922,
     0.0018446639000000075,
     1.133359999998973e-05,
     2.555200000001534e-05,
     8.0879999999972093e-06,
     3.0394999999927565e-06,
     0.0031535084999999973,
     1.8029999999669143e-07,
     5.9249999999622101e-07,
     0.00085246320000001321,
     1.9627599999996193e-05,
     0.00017291390000000461,
     5.0743999999980358e-06,
     0.0027297111000000028,
     0.0038683464000000001,
     0.00010988389999999626,
     5.4090000000783789e-07,
     1.3651799999987446e-05,
     1.7000000000066962e-06,
     0.0028003396999999987,
     0.00082389750000000817,
     2.2409999999872808e-06,
     0.0018854389000000004,
     8.9432000000009277e-05,
     0.0031650738999999995,
     0.0002863267000000036,
     0.00041104719999999871,
     0.0037462790000000012,
     1.8287999999877512e-06,
     2.0812499999998124e-05,
     5.8857200000002049e-05,
     5.9295099999996382e-05,
     2.8462600000001004e-05,
     1.1771500000001822e-05,
     0.0025297511999999855,
     7.7200000010435581e-08,
     0.00082719460000001631,
     0.00087294089999998545,
     0.0017587092000000127,
     0.00091626599999999675,
     2.7818000000046085e-06,
     3.8639999999645624e-07,
     6.2076999999938208e-06,
     3.8639999999645624e-07,
     0.0055398388000000229,
     1.107599999983222e-06,
     3.59068000000029e-05,
     3.6575999999932664e-06,
     6.8459399999998283e-05,
     0.0024331500000000085,
     0.00023033319999999692,
     0.0014492749999999966,
     3.6480800000013856e-05,
     0.0010608755999999887,
     0.0015134122999999988,
     1.2117399999986844e-05,
     9.5962000000326952e-06,
     1.1396999999995217e-05,
     0.00010481150000000383,
     1.0213599999993051e-05,
     4.5536999999740148e-06,
     1.620800000026179e-06,
     3.3958999999939009e-06,
     0.00020077300000000519,
     1.8034500000005948e-05,
     4.5047899999985932e-05,
     9.1331000000138836e-06,
     1.793159999998295e-05,
     0.0032410528000000128,
     0.0047217660999999819,
     5.7679800000016713e-05,
     0.00071929919999998756,
     0.00013341979999999864,
     0.001882053500000005,
     2.6241000000126746e-06,
     1.4921999999728542e-06,
     0.00011601240000000957,
     0.0048810659000000098,
     2.9216999999803763e-06,
     2.0482700000030716e-05,
     5.971999999943023e-07,
     0.0011858299000000016,
     4.2026999999933419e-06,
     1.5261999999793829e-06,
     9.5120000001003289e-07,
     0.00082309110000000629,
     2.5525999999977956e-05,
     0.00080245350000001997,
     9.64410000001692e-06,
     2.9198000000008051e-06,
     1.1944999999968786e-06,
     2.7206999999762615e-06,
     8.1400000000186872e-06,
     4.025699999985477e-06,
     5.8837999999994396e-06,
     1.1944999999968786e-06,
     0.0020085669999999924,
     7.9630000001884585e-07,
     0.00079462329999998357,
     3.3170000001803146e-07,
     0.00012928890000001302,
     0.0003065549999999817,
     3.943919999997547e-05,
     0.0074966963000000324,
     0.00075230850000000519,
     0.00073344049999999326,
     5.2312800000002824e-05,
     5.52999999996473e-07,
     0.0021360420999999973,
     4.6229000000153061e-06,
     9.8653999999953604e-06,
     8.2948300000005299e-05,
     5.9722999999678453e-06,
     3.2692700000005461e-05,
     2.86005999999972e-05,
     3.1410000000064998e-06,
     0.0058594062000000236,
     0.0038115547999999677,
     0.00015083330000003058,
     5.4038099999971221e-05,
     0.00093842250000001574,
     8.5447899999984149e-05,
     0.0017314089000000266,
     0.00011849449999999706,
     2.9728700000006826e-05,
     0.0013897278999999685,
     0.0018416971000000261,
     0.00013366850000000595,
     0.00028558569999997729,
     0.00011086320000000427,
     0.00054555700000001649,
     0.00064301569999997805,
     0.00016111890000001239,
     5.7952999999955067e-06,
     0.0012602842999999808,
     0.00073100740000000999,
     0.0025476871000000047,
     9.3433100000019914e-05,
     0.0061312776999999843,
     2.6322000000078562e-06,
     5.7510999999976773e-06,
     0.00015286830000000863,
     0.0016484162999999797,
     5.4392000000014207e-05,
     0.00011347340000000372,
     0.00014707299999997759,
     7.3658000000165204e-06,
     0.00098297129999998841,
     0.00030447580000000587,
     0.0031022910000000083,
     0.0016423997000000058,
     0.0033336616999999789,
     0.0006746245000000073,
     0.00019644389999999844,
     2.2296500000003048e-05,
     0.00074556199999999964,
     6.8482199999984062e-05,
     3.9820000001355994e-07,
     1.7253000000039264e-06,
     9.9317000000098681e-06,
     6.7021999999994367e-06,
     9.1795999999888524e-06,
     3.6342500000010605e-05,
     3.2006999999971696e-05,
     0.0034624859000000185,
     0.00034685689999999878,
     3.3511200000013727e-05,
     3.7159999999758499e-06,
     1.218789999999359e-05,
     0.00016627280000001577,
     3.097000000096273e-07,
     5.4635000000047284e-06,
     0.00029675609999998189,
     2.1677000000153156e-06,
     0.0013189231999999862,
     5.2733099999997532e-05,
     9.8498400000011091e-05,
     5.1981000000012047e-06,
     0.0021302909999999999,
     0.00023008770000000568,
     0.0007641866999999891,
     0.00067597389999999539,
     0.00020212850000000059,
     0.0011117292999999861,
     0.00025017230000003111,
     0.00041901089999999639,
     7.9629999998331864e-07,
     2.5946300000008192e-05,
     1.7540800000013234e-05,
     1.6589599999967675e-05,
     2.6831100000030972e-05,
     1.9597899999972411e-05,
     2.4330000002237285e-07,
     2.4994999999705668e-06,
     0.0066381476000000102,
     0.0027353274000000028,
     0.00066995739999999417,
     2.5017200000014838e-05,
     4.0611499999982926e-05,
     0.00021400680000002836,
     1.7208999999986929e-05,
     7.5869999999866876e-06,
     4.7822500000016532e-05,
     0.010575606899999989,
     0.0015237947000000319,
     3.1188999999898215e-06,
     6.6299999978980392e-08,
     0.00044336460000000245,
     0.001839750500000008,
     0.0009125425999999948,
     1.1878199999983963e-05,
     5.3396600000006346e-05,
     1.2962099999995757e-05,
     2.4641200000026231e-05,
     1.8358999999890102e-06,
     0.0011259743000000099,
     0.0064781787999999806,
     0.00015707110000001023,
     3.2514999999833093e-06,
     1.6811000000060972e-06,
     2.8977000000196539e-06,
     0.0012985731999999928,
     7.4321799999985672e-05,
     5.3440900000012447e-05,
     0.0014173330999999933,
     0.0075006335999999859,
     6.2111800000010927e-05,
     0.002539281700000018,
     2.9286299999995434e-05,
     1.1059999998508375e-07,
     0.00025355659999998893,
     5.3750000000007956e-06,
     1.7540800000013234e-05,
     1.3271999999986405e-06,
     4.8089999999945125e-07,
     9.4300000000657744e-07,
     0.0004387176999999909,
     0.0006115482999999955,
     0.00025015610000004071,
     3.0150899999981107e-05,
     5.0584999999969684e-06,
     3.7707299999993892e-05,
     3.0351000000194974e-06,
     9.6789999997071159e-07,
     0.00042263690000002188,
     8.1878300000006734e-05,
     1.781699999998665e-05,
     9.8902099999982344e-05,
     1.7416400000023203e-05,
     0.0015892045000000009,
     4.9117400000007195e-05,
     1.122700000024679e-06,
     4.0475999999500801e-06,
     2.2011000000077275e-06,
     0.00095416379999999632,
     0.000501012799999998,
     1.3295000000113078e-06,
     6.7360999999976908e-06,
     9.8677999999807747e-06,
     0.0026989045000000191,
     0.0017881265000000114,
     0.00024512930000000213,
     0.00031531189999999042,
     0.0031816736000000036,
     1.0030299999996828e-05,
     0.00014342299999999141,
     1.8612999999945145e-06,
     0.00053450130000001653,
     2.6294999999976198e-06,
     6.264869999998979e-05,
     3.3015799999986939e-05,
     7.9770000002810096e-07,
     2.46843000000041e-05,
     2.6441999999704534e-06,
     1.9809500000000922e-05,
     0.00035027760000001963,
     0.00012349539999998883,
     0.0013327595999999887,
     5.8527400000016884e-05,
     0.0011565571999999945,
     3.7447499999991865e-05,
     0.0010351744000000095,
     0.0017161712000000051,
     0.00034417669999999847,
     0.001975467199999983,
     0.00018463730000000566,
     1.2984700000018279e-05,
     0.00033661339999998321,
     0.0009629679999999752,
     1.5939200000048005e-05,
     0.00042691560000001515,
     3.7447499999956337e-05,
     0.0016315119000000066,
     0.00027786450000000685,
     5.5218400000001111e-05,
     1.9188999999997237e-05,
     9.3069999998363071e-07,
     1.159610000001976e-05,
     0.00032851819999997646,
     0.0023293049000000111,
     1.8613000000300418e-06,
     5.5041099999968427e-05,
     6.1599000000001068e-06,
     5.5912700000035898e-05,
     0.00011767509999998537,
     2.3443400000005001e-05,
     0.0003579443999999654,
     5.6130000004372959e-07,
     0.0086129858999999705,
     0.00080883520000000434,
     0.00043053479999997533,
     0.00051504640000004547,
     0.0014383215999999521,
     0.00042093290000003945,
     2.4492200000025834e-05,
     0.00016714709999995136,
     3.7344999999788796e-06,
     0.00029267719999999999,
     4.5706800000004934e-05,
     0.00015846039999999561,
     5.6223000000699128e-06,
     1.3234999999411913e-06,
     0.00023884479999999541,
     6.2153000000009229e-05,
     5.9403000000202158e-06,
     2.2253200000008632e-05,
     0.0008214803999999987,
     3.6770600000011198e-05,
     0.00011082479999998895,
     8.0107399999960194e-05,
     0.00031875730000002989,
     2.8378200000034327e-05,
     0.00076840719999999858,
     3.6257599999984791e-05,
     6.8021999999956503e-06,
     5.6427999999897335e-06,
     1.9288000000017293e-06,
     1.2034599999992678e-05,
     2.3596999999853095e-06,
     2.2674000000222351e-06,
     1.6866799999988303e-05,
     8.4334399999974613e-05,
     0.0015875895000000638,
     9.9517999999676469e-06,
     1.9483100000030618e-05,
     6.0049800000001595e-05,
     4.3326499999949421e-05,
     0.00048332209999998101,
     7.5562400000066536e-05,
     1.0167299999963574e-05,
     2.5905700000024013e-05,
     0.00094886429999995413,
     0.0015433600000000069,
     0.0018469535999999919,
     6.5261700000007744e-05,
     0.00013249319999999898,
     0.00055488320000002039,
     0.00062552099999997775,
     0.0020332381000000054,
     0.00024085570000003997,
     3.9325199999993286e-05,
     1.8795699999998306e-05,
     1.5266400000015779e-05,
     0.00095619999999996708,
     0.0002027205000000265,
     3.2092199999951276e-05,
     0.0013277944000000019,
     3.2123000000012777e-05,
     0.00017245459999998047,
     9.4553000000061611e-05,
     0.00066955539999995043,
     4.196200000023964e-06,
     0.00019009089999997287,
     8.412900000038803e-06,
     0.0021820133999999312,
     0.000770346300000071,
     5.7977299999976139e-05,
     0.00039885440000006158,
     1.0075000000000501e-05,
     0.00012864579999991577,
     2.2571000000226606e-06,
     2.5751999999812369e-06,
     2.617239999999299e-05,
     2.9750000003048171e-07,
     3.5980600000016242e-05,
     1.7031000000145013e-06,
     0.00094558119999994968,
     0.0012288297999999997,
     0.00034362670000000152,
     0.00030188010000003373,
     0.0012514524000000193,
     4.1029999998443144e-07,
     1.5082000000177231e-06,
     9.8995399999992625e-05,
     1.7174699999955578e-05,
     0.0011138293000000487,
     1.9298399999954085e-05,
     2.9342999999926177e-06,
     0.00064201849999996337,
     2.7865200000078973e-05,
     3.2923199999999041e-05,
     0.0013532691999999713,
     1.200399999987667e-06,
     0.0022830197000000396,
     7.7459999999973658e-06,
     6.9970999999924287e-06,
     0.0026670899999999874,
     4.2618599999997288e-05,
     7.7870799999999458e-05,
     1.0454600000002756e-05,
     0.00076040460000001528,
     2.0396199999979102e-05,
     1.369670000002543e-05,
     6.4481900000004083e-05,
     0.00076764799999999415,
     9.5404499999958154e-05,
     0.0012519654000000457,
     0.0018858068000000116,
     0.00073670489999997811,
     5.0498000000018808e-05,
     3.908899999984783e-06,
     6.0539999999775775e-07,
     3.0699999982175539e-08,
     1.2650199999981738e-05,
     3.0961000000004903e-05,
     4.0466800000018564e-05,
     0.0017169435000000278,
     0.0020319392999999762,
     3.611519999999757e-05,
     0.00013504410000003019,
     0.00033416819999999348,
     0.00020459930000001235,
     0.00067104719999996117,
     0.0014277720999999843,
     0.0025636622000000386,
     1.5693999999655261e-06,
     5.7784999999910272e-06,
     1.1325000000041997e-05,
     6.2598999999607942e-06,
     0.00011822600000002125,
     0.0046641223000000306,
     0.0011050457999999708,
     1.0614199999992025e-05,
     1.8034599999978694e-05,
     4.0952000000515913e-06,
     5.941599999985669e-06,
     0.00047142839999999355,
     9.6249999998576635e-07,
     0.00022555940000003715,
     0.00115691819999995,
     1.4001000000263274e-06,
     0.00037749679999997453,
     1.0156000000449695e-06,
     0.00012992189999998515,
     0.0058781233999999931,
     3.8263999999799129e-06,
     1.8054000000233827e-06,
     6.842299999973989e-06,
     8.3831199999977453e-05,
     1.7613600000032648e-05,
     0.00011679120000003707,
     1.0555899999999951e-05,
     7.2567499999962588e-05,
     0.0032212430999999952,
     8.5144000000525459e-06,
     0.00047696169999994709,
     2.8774700000013807e-05,
     1.8700900000041541e-05,
     7.2628999999579943e-06,
     2.413789999998528e-05,
     0.0032607480000000065,
     0.00030556529999998361,
     0.00088380759999999729,
     0.0014579364000000083,
     9.7197800000046187e-05,
     5.846999999903346e-07,
     4.6203599999969926e-05,
     0.0001801057000000128,
     2.8730000003918119e-07,
     0.00072203349999995221,
     0.00012590060000000847,
     0.0020458830999999832,
     2.8497700000045255e-05,
     0.00075778390000003526,
     1.9900999999578061e-06,
     1.0678899999945202e-05,
     3.5910000001138087e-07,
     0.0010357747000000472,
     0.00049800159999996646,
     0.0020086965000000135,
     0.00010052149999999926,
     5.1394999999843092e-06,
     1.887499999995157e-06,
     0.001640493900000024,
     0.0019040614000000033,
     8.0939000000057604e-06,
     1.7540999999710038e-06,
     0.00085735140000004146,
     5.3743499999967526e-05,
     1.5172000000021057e-05,
     2.9379899999995019e-05,
     5.9652300000010427e-05,
     3.6519999999740096e-06,
     5.6154200000051444e-05,
     1.9572899999928951e-05,
     7.7960000005816715e-07,
     5.4102499999970631e-05,
     0.00011207239999997399,
     9.2330000001084045e-07,
     2.5071399999987422e-05,
     8.1451000000498658e-06,
     1.6310999999546993e-06,
     5.6419999999945963e-07,
     1.0381400000056828e-05,
     0.00010421449999995503,
     2.2261000000156627e-06,
     3.4878000000304609e-06,
     1.0463999999643647e-06,
     0.00026203909999999552,
     8.4938999999906167e-06,
     0.0017502376000000197,
     7.2618900000023239e-05,
     3.5114299999960966e-05,
     1.4289800000000241e-05,
     2.7235900000022183e-05,
     0.00074623299999998949,
     0.00035027120000002298,
     0.00077783889999999195,
     3.5073299999979212e-05,
     2.2464999999982636e-06,
     2.9750000003048171e-07,
     4.9445999999875309e-06,
     1.1079000000080441e-06,
     0.0005524528000000117,
     6.1508999999944079e-05,
     0.0015757740000000098,
     0.0016344927000000098,
     3.2313800000025596e-05,
     2.0116600000008589e-05,
     0.0023136233999999688,
     0.0019390813999999779,
     7.686699999993607e-06,
     3.2114200000066263e-05,
     5.7354599999968058e-05,
     0.0010669919000000051,
     0.0014448412000000132,
     0.002018387600000011,
     0.000159018599999996,
     4.0521499999996993e-05,
     2.3300299999959862e-05,
     0.0023972717000000188,
     1.5705999999937604e-06,
     4.1575000000193543e-06,
     3.4738000000089642e-06,
     0.0015906853999999981,
     6.2897899999967419e-05,
     1.7590699999985303e-05,
     1.4689700000047879e-05,
     0.00058470679999999219,
     0.0025247489999999572,
     0.0056024786000000402,
     2.328200000007996e-06,
     1.2379999999723169e-06,
     1.9771000000190499e-06,
     2.2912000000019361e-06,
     1.6998999999628949e-06,
     1.1087000000031822e-06,
     0.00010090640000001372,
     1.0532300000036798e-05,
     9.092849999994712e-05,
     6.7000000000021483e-05,
     5.2032999999980235e-05,
     4.7673000000258981e-06,
     3.935699999999542e-06,
     0.0017613633999999934,
     1.0680099999973437e-05,
     3.3555400000011561e-05,
     0.00088831300000002499,
     4.578760000001125e-05,
     0.0013191747999999849,
     1.230610000000354e-05,
     1.4689699999976824e-05,
     3.1419999999116046e-07,
     4.2609400000017671e-05,
     0.00013994969999998831,
     2.9859899999991057e-05,
     1.8200499999991848e-05,
     8.9912200000057398e-05,
     3.8636799999949289e-05,
     0.0028921586000000589,
     0.0019460289999999958,
     0.00013967259999994041,
     2.633060000000853e-05,
     0.00114583599999996,
     0.0073259998000000338,
     0.00074514820000004534,
     8.0691900000005041e-05,
     4.8410999999504157e-06,
     1.0174000000517935e-06,
     0.00022343749999997442,
     9.9020000000393792e-07,
     0.00075237690000001583,
     0.00061322910000001225,
     0.00012378679999997644,
     3.1375900000014669e-05,
     3.7698999999946638e-06,
     6.1133999999896101e-06,
     2.3209499999978789e-05,
     0.00013814850000002822,
     4.4328999999976304e-06,
     2.6470600000010337e-05,
     4.5201699999992686e-05,
     1.3653099999970664e-05,
     0.001122719800000027,
     0.00027341739999997116,
     6.2679999999204485e-07,
     0.0011907585000000154,
     0.00033153630000001046,
     0.0026430707000000097,
     9.4470000000512755e-07,
     2.270999999964829e-06,
     2.9977000000513955e-06,
     0.00090407859999999121,
     5.3140999999357065e-06,
     4.0550700000068221e-05,
     0.00039615949999998178,
     4.223999999979355e-06,
     0.00082218690000004815,
     0.00042467389999998771,
     7.8993899999986179e-05,
     1.126410000004796e-05,
     0.0011820923999999167,
     2.0520600000040191e-05,
     9.5299600000018362e-05,
     0.0004355655999999897,
     1.9070000000454002e-07,
     0.00013783969999998648,
     0.00024320410000001403,
     2.8432999999239427e-06,
     0.003923115200000069,
     0.00038776589999997666,
     0.00018265970000001631,
     0.0023234706999999588,
     0.00030480230000001996,
     1.2717500000007931e-05,
     1.4216399999966712e-05,
     0.00036772670000004835,
     0.00015837839999996106,
     0.00048106700000005275,
     1.5615299999964803e-05,
     3.4809599999974236e-05,
     3.5246000000199727e-06,
     5.468499999992105e-06,
     6.0281000000017572e-05,
     0.00043985320000004434,
     0.00016450100000000133,
     0.00038914669999996933,
     1.0537300000024174e-05,
     0.00074599999999996674,
     1.329890000000944e-05,
     2.5070999999599054e-06,
     0.0015457677999999931,
     2.0529000000379939e-06,
     3.660899999999856e-06,
     3.4382699999966348e-05,
     2.3073000000550791e-06,
     6.8128999999572668e-06,
     4.0378099999998088e-05,
     0.00017230410000003361,
     0.0010673441000000139,
     0.00033053719999990959,
     5.2777000000503446e-06,
     0.001240801900000008,
     0.00042738999999997418,
     1.8259000000142579e-06,
     0.00052961160000002398,
     0.00014786819999997646,
     0.00030571989999998549,
     0.00042464660000000263,
     0.00072887680000000899,
     0.00055120410000000677,
     0.00016515500000004125,
     0.0009892313999999658,
     9.3936899999960127e-05,
     8.1029000000398817e-06,
     6.6310000001124082e-07,
     3.5445500000008678e-05,
     4.0096499999933143e-05,
     0.00096280620000001706,
     4.9599000000455362e-06,
     0.0016177487999999584,
     2.1883200000019086e-05,
     0.00036879869999999925,
     1.9466800000031982e-05,
     5.1669399999951791e-05,
     2.1809999999788943e-07,
     0.00019726670000004277,
     5.6574699999956123e-05,
     0.0033419160000000402,
     0.0014227531000000227,
     0.00072321739999999576,
     0.00030482049999996263,
     0.0010309539000000001,
     8.7405600000067812e-05,
     3.9569699999972842e-05,
     0.0010335063999999505,
     5.0679300000027181e-05,
     0.00089886440000000792,
     0.00045227099999998186,
     0.00049305779999997412,
     4.6782000000433752e-06,
     0.0005544469999999535,
     0.000306819000000047,
     5.3649699999951396e-05,
     0.00033784060000002113,
     0.00060515360000003683,
     0.00094753609999997934,
     0.00037979929999998774,
     8.8110000000085616e-07,
     5.6956299999981754e-05,
     0.0010989381000000265,
     0.00022580839999996271,
     6.0181100000065159e-05,
     7.6122999999483911e-06,
     0.00048471880000001022,
     0.00064811150000004152,
     0.00010904349999997009,
     0.0011966540000000235,
     0.00048553630000000678,
     4.4147999999921697e-06,
     0.00044688409999999124,
     0.00047669769999998836,
     0.00056003359999998279,
     0.00072848610000001205,
     9.671670000003019e-05,
     1.45339999995997e-06,
     0.0017056176999999907,
     0.00057550360000000465,
     5.3959000000247667e-06,
     3.0104100000016841e-05,
     1.6905199999968089e-05,
     2.1247399999992921e-05,
     4.3966200000014053e-05,
     0.00039876659999997342,
     5.4500000032930985e-08,
     0.00085643329999996354,
     4.4510000002162542e-07,
     1.3807999999926323e-06,
     1.1991000000222129e-06,
     2.9668099999966557e-05,
     6.701220000003616e-05,
     4.2690000000789042e-07,
     0.00067722549999999155,
     0.00036543760000000701,
     3.1357800000009209e-05,
     4.0880000000242946e-07,
     8.1300999999456276e-06,
     0.00018592090000005613,
     0.00029936100000000466,
     0.00044241489999997442,
     0.00082993549999997639,
     0.00096043530000009978,
     1.0646399999885148e-05,
     0.00081835350000005749,
     0.0021545457999999941,
     8.5652399999958109e-05,
     7.6300000003470817e-07,
     9.0294999999684926e-06,
     2.3054999999985172e-05,
     5.4776000000344995e-06,
     1.0455600000014442e-05,
     0.00069372189999995727,
     8.9386000000502014e-06,
     0.00068620949999996126,
     8.0937999999974863e-06,
     5.2541499999989583e-05,
     0.00014824070000003076,
     7.5669000000289087e-06,
     0.00065965719999994121,
     0.00014526119999999309,
     0.00069619270000004013,
     5.1778999999640977e-06,
     6.9038000000176681e-06,
     0.00018033420000001854,
     2.1719699999991348e-05,
     0.00021262769999999876,
     0.00017966200000003597,
     1.9257999999666708e-06,
     0.0015040634000000352,
     ...]



Using the parameters.PopulationStructure class
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. code:: python

    popst = parameters.PopulationStructure(tuson)
    struct_mating_probs = popst.parse_and_remap_population_structure('population_structure_matrix.xlsx')

.. code:: python

    struct_mating_probs




.. parsed-literal::

    {1: [0.0, 0.99960000000000004, 0.0, 0.00040000000000000002, 0.0, 0.0],
     2: [0.010999999999999999,
      0.0015,
      0.00040000000000000002,
      0.1047,
      0.0,
      0.88239999999999996],
     3: [0.0, 0.38319999999999999, 0.0, 0.61680000000000001, 0.0, 0.0],
     4: [0.0,
      0.40849999999999997,
      0.51339999999999997,
      0.078200000000000006,
      0.0,
      0.0],
     5: [0.0,
      0.00089999999999999998,
      0.0,
      0.0047999999999999996,
      0.0,
      0.99429999999999996],
     6: [0.2195,
      0.019800000000000002,
      0.021000000000000001,
      0.23710000000000001,
      0.1295,
      0.37309999999999999],
     7: [0.0, 0.49070000000000003, 0.0, 0.50929999999999997, 0.0, 0.0],
     8: [0.99939999999999996, 0.0, 0.0, 0.00059999999999999995, 0.0, 0.0],
     9: [0.41549999999999998,
      0.0079000000000000008,
      0.00069999999999999999,
      0.5736,
      0.00050000000000000001,
      0.0018],
     10: [0.0, 0.4622, 0.0, 0.53779999999999994, 0.0, 0.0],
     11: [0.0, 0.00029999999999999997, 0.0, 0.0115, 0.0, 0.98819999999999997],
     12: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     13: [0.92430000000000001,
      0.001,
      0.00080000000000000004,
      0.072900000000000006,
      0.001,
      0.0],
     14: [0.38129999999999997,
      0.0014,
      0.6129,
      0.0023999999999999998,
      0.00080000000000000004,
      0.0011999999999999999],
     15: [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     16: [0.090800000000000006,
      0.0184,
      0.0014,
      0.1178,
      0.0044000000000000003,
      0.76729999999999998],
     17: [0.00089999999999999998,
      0.0014,
      0.0,
      0.27050000000000002,
      0.72619999999999996,
      0.001],
     18: [0.0054999999999999997,
      0.55640000000000001,
      0.0047000000000000002,
      0.032399999999999998,
      0.3745,
      0.026499999999999999],
     19: [0.00089999999999999998,
      0.0025999999999999999,
      0.0023999999999999998,
      0.27339999999999998,
      0.7198,
      0.00089999999999999998],
     20: [0.0, 0.99609999999999999, 0.0, 0.0038999999999999998, 0.0, 0.0],
     21: [0.0, 0.38019999999999998, 0.0, 0.61980000000000002, 0.0, 0.0],
     22: [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     23: [0.062,
      0.0011999999999999999,
      0.0092999999999999992,
      0.16650000000000001,
      0.034200000000000001,
      0.72670000000000001],
     24: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     25: [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     26: [0.1668,
      0.0030000000000000001,
      0.0022000000000000001,
      0.16139999999999999,
      0.0722,
      0.59440000000000004],
     27: [0.0071000000000000004,
      0.002,
      0.0011999999999999999,
      0.21840000000000001,
      0.77059999999999995,
      0.00069999999999999999],
     28: [0.0, 0.35320000000000001, 0.0, 0.64680000000000004, 0.0, 0.0],
     29: [0.0, 0.0, 0.0, 0.0, 0.0, 1.0],
     30: [0.00050000000000000001,
      0.95089999999999997,
      0.0,
      0.048599999999999997,
      0.0,
      0.0],
     31: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     32: [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     33: [0.0, 0.99870000000000003, 0.0, 0.0012999999999999999, 0.0, 0.0],
     34: [0.88570000000000004,
      0.0016000000000000001,
      0.00089999999999999998,
      0.1065,
      0.0041999999999999997,
      0.0011000000000000001],
     35: [0.0, 0.41549999999999998, 0.0, 0.58450000000000002, 0.0, 0.0],
     36: [0.3906,
      0.0023,
      0.0001,
      0.60680000000000001,
      0.0,
      0.00020000000000000001],
     37: [0.0, 0.46810000000000002, 0.0, 0.53190000000000004, 0.0, 0.0],
     38: [0.0, 0.999, 0.0, 0.001, 0.0, 0.0],
     39: [0.27539999999999998,
      0.0080000000000000002,
      0.052600000000000001,
      0.23000000000000001,
      0.16520000000000001,
      0.26879999999999998],
     40: [0.90380000000000005,
      0.0050000000000000001,
      0.0016999999999999999,
      0.0872,
      0.001,
      0.0012999999999999999],
     41: [0.14280000000000001,
      0.010200000000000001,
      0.0020999999999999999,
      0.081299999999999997,
      0.017899999999999999,
      0.74580000000000002],
     42: [0.99129999999999996,
      0.0012999999999999999,
      0.0016000000000000001,
      0.0038999999999999998,
      0.00089999999999999998,
      0.001],
     43: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     44: [0.0, 0.42109999999999997, 0.0, 0.57889999999999997, 0.0, 0.0],
     45: [0.0, 0.48220000000000002, 0.0, 0.51780000000000004, 0.0, 0.0],
     46: [0.0, 0.5514, 0.0, 0.4486, 0.0, 0.0],
     47: [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     48: [0.001, 0.001, 0.00050000000000000001, 0.2455, 0.752, 0.0],
     49: [0.095899999999999999,
      0.50890000000000002,
      0.047899999999999998,
      0.1777,
      0.13669999999999999,
      0.032800000000000003],
     50: [0.73980000000000001,
      0.0061999999999999998,
      0.0037000000000000002,
      0.16589999999999999,
      0.058099999999999999,
      0.0264],
     51: [0.92290000000000005,
      0.0016999999999999999,
      0.001,
      0.072800000000000004,
      0.00069999999999999999,
      0.00089999999999999998],
     52: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     53: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     54: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     55: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     56: [0.39190000000000003,
      0.0016000000000000001,
      0.52639999999999998,
      0.070199999999999999,
      0.0033999999999999998,
      0.0064999999999999997],
     57: [0.96240000000000003,
      0.001,
      0.00080000000000000004,
      0.035099999999999999,
      0.00050000000000000001,
      0.00020000000000000001],
     58: [0.0, 0.35670000000000002, 0.0, 0.64329999999999998, 0.0, 0.0],
     59: [0.0, 0.497, 0.0, 0.503, 0.0, 0.0],
     60: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     61: [0.0, 0.43099999999999999, 0.0, 0.56899999999999995, 0.0, 0.0],
     62: [0.0028,
      0.0030000000000000001,
      0.97929999999999995,
      0.010699999999999999,
      0.00080000000000000004,
      0.0033999999999999998],
     63: [0.0, 0.99809999999999999, 0.0, 0.0019, 0.0, 0.0],
     64: [0.0, 0.49349999999999999, 0.0, 0.50649999999999995, 0.0, 0.0],
     65: [0.0, 0.999, 0.0, 0.001, 0.0, 0.0],
     66: [0.12959999999999999,
      0.041700000000000001,
      0.00089999999999999998,
      0.13300000000000001,
      0.051499999999999997,
      0.64319999999999999],
     67: [0.4632,
      0.51670000000000005,
      0.0023999999999999998,
      0.016299999999999999,
      0.00040000000000000002,
      0.001],
     68: [0.0, 0.38679999999999998, 0.0, 0.61319999999999997, 0.0, 0.0],
     69: [0.0011000000000000001, 0.001, 0.99509999999999998, 0.0028, 0.0, 0.0],
     70: [0.23669999999999999,
      0.084400000000000003,
      0.076499999999999999,
      0.14000000000000001,
      0.1208,
      0.34160000000000001],
     71: [0.99780000000000002, 0.0001, 0.0001, 0.002, 0.0, 0.0],
     72: [0.1022,
      0.0070000000000000001,
      0.026599999999999999,
      0.105,
      0.0011000000000000001,
      0.7581],
     73: [0.88939999999999997,
      0.0030999999999999999,
      0.0033,
      0.097900000000000001,
      0.0011000000000000001,
      0.0051999999999999998],
     74: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     75: [0.096600000000000005,
      0.0018,
      0.042299999999999997,
      0.67930000000000001,
      0.092799999999999994,
      0.0872],
     76: [0.0, 0.999, 0.0, 0.001, 0.0, 0.0],
     77: [0.38990000000000002,
      0.011599999999999999,
      0.001,
      0.59079999999999999,
      0.0057999999999999996,
      0.00089999999999999998],
     78: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     79: [0.0877,
      0.0071000000000000004,
      0.001,
      0.076600000000000001,
      0.00040000000000000002,
      0.82709999999999995],
     80: [0.0, 0.99880000000000002, 0.0, 0.0011999999999999999, 0.0, 0.0],
     81: [0.20250000000000001,
      0.038899999999999997,
      0.0143,
      0.13389999999999999,
      0.061400000000000003,
      0.54900000000000004],
     82: [0.46970000000000001,
      0.00020000000000000001,
      0.52910000000000001,
      0.001,
      0.0,
      0.0],
     83: [0.0, 0.48659999999999998, 0.0, 0.51339999999999997, 0.0, 0.0],
     84: [0.0, 0.50800000000000001, 0.0, 0.49199999999999999, 0.0, 0.0],
     85: [0.0, 0.99829999999999997, 0.0, 0.0016999999999999999, 0.0, 0.0],
     86: [0.93600000000000005,
      0.0016000000000000001,
      0.001,
      0.060499999999999998,
      0.0,
      0.00089999999999999998],
     87: [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     88: [0.0, 0.38790000000000002, 0.0, 0.61209999999999998, 0.0, 0.0],
     89: [0.0, 0.4803, 0.0, 0.51970000000000005, 0.0, 0.0],
     90: [0.92149999999999999,
      0.0016000000000000001,
      0.001,
      0.074300000000000005,
      0.00029999999999999997,
      0.0012999999999999999],
     91: [0.0033999999999999998,
      0.001,
      0.0016000000000000001,
      0.25259999999999999,
      0.74070000000000003,
      0.00069999999999999999],
     92: [0.0, 0.4778, 0.0, 0.5222, 0.0, 0.0],
     93: [0.99319999999999997,
      0.002,
      0.00020000000000000001,
      0.0044999999999999997,
      0.0,
      0.0001],
     94: [0.0016999999999999999,
      0.028799999999999999,
      0.002,
      0.2059,
      0.76060000000000005,
      0.001],
     95: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     96: [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     97: [0.0, 0.0, 0.99950000000000006, 0.00050000000000000001, 0.0, 0.0],
     98: [0.0, 0.49020000000000002, 0.0, 0.50980000000000003, 0.0, 0.0],
     99: [0.043700000000000003,
      0.0019,
      0.063100000000000003,
      0.67800000000000005,
      0.13880000000000001,
      0.074399999999999994],
     100: [0.80879999999999996,
      0.0064999999999999997,
      0.041300000000000003,
      0.1159,
      0.021700000000000001,
      0.0057000000000000002],
     101: [0.99629999999999996,
      0.00089999999999999998,
      0.00069999999999999999,
      0.0019,
      0.0,
      0.00020000000000000001],
     102: [0.41799999999999998,
      0.001,
      0.0001,
      0.58069999999999999,
      0.00020000000000000001,
      0.0],
     103: [0.0155,
      0.001,
      0.001,
      0.69099999999999995,
      0.29039999999999999,
      0.0011000000000000001],
     104: [0.12670000000000001,
      0.0080000000000000002,
      0.0063,
      0.21190000000000001,
      0.37440000000000001,
      0.2727],
     105: [0.0, 0.4602, 0.0, 0.53979999999999995, 0.0, 0.0]}



.. code:: python

    mating_pmfs = popst.generate_mating_pmfs(struct_mating_probs)

.. code:: python

    mating_pmfs




.. parsed-literal::

    {1: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf50f0>,
     2: <scipy.stats._distn_infrastructure.rv_discrete at 0xe52ee10>,
     3: <scipy.stats._distn_infrastructure.rv_discrete at 0xe52e390>,
     4: <scipy.stats._distn_infrastructure.rv_discrete at 0xe520748>,
     5: <scipy.stats._distn_infrastructure.rv_discrete at 0xe52e908>,
     6: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf5898>,
     7: <scipy.stats._distn_infrastructure.rv_discrete at 0xe520b38>,
     8: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517be0>,
     9: <scipy.stats._distn_infrastructure.rv_discrete at 0xe5204a8>,
     10: <scipy.stats._distn_infrastructure.rv_discrete at 0x2bb3d30>,
     11: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517da0>,
     12: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf18d0>,
     13: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01d9b0>,
     14: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517978>,
     15: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf54e0>,
     16: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01d0f0>,
     17: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01dfd0>,
     18: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01d9e8>,
     19: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf5630>,
     20: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517358>,
     21: <scipy.stats._distn_infrastructure.rv_discrete at 0xe012a58>,
     22: <scipy.stats._distn_infrastructure.rv_discrete at 0xe52ef28>,
     23: <scipy.stats._distn_infrastructure.rv_discrete at 0xe0122e8>,
     24: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01dd68>,
     25: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf5780>,
     26: <scipy.stats._distn_infrastructure.rv_discrete at 0xe5205f8>,
     27: <scipy.stats._distn_infrastructure.rv_discrete at 0x2bb3cc0>,
     28: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01dc50>,
     29: <scipy.stats._distn_infrastructure.rv_discrete at 0xe012be0>,
     30: <scipy.stats._distn_infrastructure.rv_discrete at 0xe520f60>,
     31: <scipy.stats._distn_infrastructure.rv_discrete at 0xe520ef0>,
     32: <scipy.stats._distn_infrastructure.rv_discrete at 0xe0126a0>,
     33: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517780>,
     34: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00a4a8>,
     35: <scipy.stats._distn_infrastructure.rv_discrete at 0xdffb358>,
     36: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00a390>,
     37: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517160>,
     38: <scipy.stats._distn_infrastructure.rv_discrete at 0xe012898>,
     39: <scipy.stats._distn_infrastructure.rv_discrete at 0xdffbb38>,
     40: <scipy.stats._distn_infrastructure.rv_discrete at 0xdffb668>,
     41: <scipy.stats._distn_infrastructure.rv_discrete at 0xe0124e0>,
     42: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517ef0>,
     43: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00af28>,
     44: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6ef28>,
     45: <scipy.stats._distn_infrastructure.rv_discrete at 0xe517278>,
     46: <scipy.stats._distn_infrastructure.rv_discrete at 0xe52e710>,
     47: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6e630>,
     48: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf63748>,
     49: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6eb70>,
     50: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01d8d0>,
     51: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00a128>,
     52: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf63f28>,
     53: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf633c8>,
     54: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf5240>,
     55: <scipy.stats._distn_infrastructure.rv_discrete at 0xe520b70>,
     56: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf52710>,
     57: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4f358>,
     58: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6eb38>,
     59: <scipy.stats._distn_infrastructure.rv_discrete at 0xe012390>,
     60: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf63b00>,
     61: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4fb00>,
     62: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf5710>,
     63: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6e588>,
     64: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf52b00>,
     65: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3e320>,
     66: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4f208>,
     67: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf526d8>,
     68: <scipy.stats._distn_infrastructure.rv_discrete at 0xe01dac8>,
     69: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3eac8>,
     70: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf34710>,
     71: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf63400>,
     72: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6e2e8>,
     73: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4f6a0>,
     74: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf34ef0>,
     75: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf34908>,
     76: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3e048>,
     77: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4fef0>,
     78: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf52128>,
     79: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6e128>,
     80: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf52d68>,
     81: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3e160>,
     82: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf52940>,
     83: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3e668>,
     84: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf349b0>,
     85: <scipy.stats._distn_infrastructure.rv_discrete at 0xe012ba8>,
     86: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3ecf8>,
     87: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4fd68>,
     88: <scipy.stats._distn_infrastructure.rv_discrete at 0xdffb828>,
     89: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6ee10>,
     90: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf520f0>,
     91: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf348d0>,
     92: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00a9e8>,
     93: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00a400>,
     94: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf34470>,
     95: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf4f3c8>,
     96: <scipy.stats._distn_infrastructure.rv_discrete at 0xe4f47f0>,
     97: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf6e208>,
     98: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf3e898>,
     99: <scipy.stats._distn_infrastructure.rv_discrete at 0xe00a9b0>,
     100: <scipy.stats._distn_infrastructure.rv_discrete at 0xe4f4f60>,
     101: <scipy.stats._distn_infrastructure.rv_discrete at 0xe4f4630>,
     102: <scipy.stats._distn_infrastructure.rv_discrete at 0x9cf1588>,
     103: <scipy.stats._distn_infrastructure.rv_discrete at 0xdf52a58>,
     104: <scipy.stats._distn_infrastructure.rv_discrete at 0xdc73b70>,
     105: <scipy.stats._distn_infrastructure.rv_discrete at 0xdc73d68>}



.. code:: python

    popst.assign_primary_subpopulations(struct_mating_probs)

.. code:: python

    tuson.dvars().mating_pmfs = mating_pmfs

.. code:: python

    pop_struct_expansion = breed.ForcedPopulationStructureParentChooser(2000, mating_pmfs)

.. code:: python

    primary_subpopulation_splitter = sim.InfoSplitter(field='primary', values=list(range(6)))
    tuson.setVirtualSplitter(primary_subpopulation_splitter)

.. code:: python

    sim.tagID(tuson, reset=False)

.. code:: python

    multi_son = sim.Simulator(tuson, rep=2)

Structured Population Expansion
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code:: python

    multi_son.evolve(
        matingScheme=sim.HomoMating(
            sim.PyParentsChooser(pop_struct_expansion.forced_structure_parent_chooser),
            sim.OffspringGenerator(ops=[sim.IdTagger(), sim.ParentsTagger(), sim.PedigreeTagger(),
                                       sim.Recombinator(recom_rates)], numOffspring=1),
                subPopSize=2000),
        gen=1
    )




.. parsed-literal::

    (1, 1)



Choose QTL and Determine Allele Effects
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code:: python

    qtl = sorted(random.sample(tuple(range(44445)), 50))
    additive_trait = parameters.Trait()
    allele_effects = additive_trait.assign_allele_effects(alleles, qtl, random.expovariate, 1, multiplicity=1)
    ae_array = additive_trait.convert_allele_effects_into_array(44445, 5, allele_effects)

.. code:: python

    qtl




.. parsed-literal::

    [26,
     274,
     398,
     813,
     1399,
     1589,
     3397,
     5264,
     5919,
     5927,
     7775,
     8297,
     8724,
     8939,
     9208,
     10574,
     11215,
     11607,
     13135,
     15271,
     18107,
     19493,
     20140,
     20401,
     21673,
     24015,
     24798,
     24880,
     25709,
     27818,
     27981,
     28235,
     29140,
     29423,
     30464,
     31062,
     31173,
     32737,
     32898,
     33802,
     34347,
     34649,
     34767,
     36421,
     37318,
     37593,
     38712,
     38750,
     43976,
     44056]



.. code:: python

    allele_effects




.. parsed-literal::

    {26: {1: 0.5219397892559715, 3: 1.273867258408594},
     274: {1: 1.0160226134020842, 2: 5.552410578395551},
     398: {2: 0.14379333250075946, 3: 0.48879008140660024},
     813: {1: 0.3147854424813585, 3: 0.5537398242239526},
     1399: {1: 0.3368009665011774, 3: 0.7859151646745403},
     1589: {1: 0.7219849833852372, 3: 2.1518798956087397},
     3397: {1: 1.761637972789823, 2: 0.11752428149902522},
     5264: {1: 0.23112484003764824, 2: 1.034359111522724},
     5919: {1: 0.655938375751044, 2: 0.06910966283618566},
     5927: {1: 0.8284871116775173, 3: 0.4402150444919753},
     7775: {1: 1.0179460090870973, 4: 1.104060345590196},
     8297: {1: 1.0013283790522547, 3: 1.8994074935045697},
     8724: {1: 0.2739099430864379, 2: 3.53392320403459},
     8939: {1: 0.21610286589612537, 3: 0.4904492577137334},
     9208: {1: 0.5416205880106514, 3: 2.3134915146842197},
     10574: {1: 1.1254980539204165, 3: 1.4703848373399502},
     11215: {1: 1.2140610204815148, 2: 0.40069943475167397},
     11607: {1: 1.1429502186946319, 3: 1.061441460104546},
     13135: {1: 1.1393368479668797, 2: 0.2631755485622469},
     15271: {1: 0.08122166032434996, 3: 0.8471006601970865},
     18107: {1: 1.2959473232258218, 2: 1.9723638475558247},
     19493: {1: 1.0878451493656605, 3: 0.271399953402532},
     20140: {1: 0.4455335242798739, 3: 0.8384845642109361},
     20401: {1: 0.25860923195201474, 2: 0.8205089830049811},
     21673: {1: 0.7605904020150047, 2: 1.314142480553199},
     24015: {1: 1.3645240894473372, 3: 0.8371718214336693},
     24798: {1: 1.382614266703403, 3: 0.3395453446836415},
     24880: {1: 0.5860056901279319, 3: 0.21073829559927418},
     25709: {1: 0.19443224380508045, 4: 0.18261802499531452},
     27818: {1: 0.25096907140027114, 3: 0.9101678201978418},
     27981: {1: 0.3768738980172961, 3: 1.0242131993215355},
     28235: {1: 2.449598600999007, 3: 0.8151391356854939},
     29140: {1: 2.2027432789964325, 2: 1.690375590170189},
     29423: {1: 1.977598840998496, 2: 0.2953023669116938},
     30464: {1: 0.050281623427198156, 3: 0.04445725997806134},
     31062: {1: 0.25588958429878184, 3: 5.376660099576972},
     31173: {1: 0.9583078665719502, 3: 2.1455040275625925},
     32737: {1: 0.3884290184769246, 3: 0.5878487765186341},
     32898: {1: 1.0273909496664468, 3: 2.4593568290214005},
     33802: {1: 0.12096652782895292, 3: 2.3697811298199905},
     34347: {1: 2.423738344237365, 3: 3.306910890927586},
     34649: {1: 0.21284552431736334, 3: 1.5000954288751518},
     34767: {1: 0.6541291315802819, 3: 1.0763432838416578},
     36421: {1: 2.4423946346638252, 2: 0.6249611392087835},
     37318: {2: 1.4117281930900565, 3: 0.9893980054540521},
     37593: {1: 0.07136097018757592, 3: 0.2418530241023536},
     38712: {1: 1.4291485077599613, 3: 0.12090995040135354},
     38750: {1: 2.4987709631386377, 3: 0.4350792517176955},
     43976: {1: 1.7087675060411993, 3: 0.9587080625543358},
     44056: {1: 0.7061377378109918, 3: 1.2340994385326471}}



.. code:: python

    ae_array




.. parsed-literal::

    array([[ 0.,  0.,  0.,  0.,  0.],
           [ 0.,  0.,  0.,  0.,  0.],
           [ 0.,  0.,  0.,  0.,  0.],
           ..., 
           [ 0.,  0.,  0.,  0.,  0.],
           [ 0.,  0.,  0.,  0.,  0.],
           [ 0.,  0.,  0.,  0.,  0.]])



.. code:: python

    np.savetxt('demo_artemis_QTL.txt', np.asarray(qtl), fmt='%d', delimiter='\t')
    np.savetxt('demo_artemis_allele_effects.txt', ae_array, delimiter='\t', fmt='%.4f')

Population Sampling Parameters
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. code:: python

    sampling_generations = [i for i in range(2, 10, 2)]
    sample_sizes = {i: 200 for i in range(11)}
    meta_populations = {rep: [] for rep in range(2)}

Selection Parameters and Simulation
===================================

.. code:: python

    trun = simulate.Truncation(10, 2000, 0.05, 0.50, 5, 0.7, sample_sizes, 1)

.. code:: python

    trun.replicate_selection(multi_son, meta_populations, qtl, ae_array, recom_rates)


.. parsed-literal::

    Initial: Sampled 200 individuals from generation 0 Replicate: 0.
    Initial: Sampled 200 individuals from generation 0 Replicate: 1.
    Generation: 0
    Generation: 0
    Generation: 1
    Generation: 1
    Generation: 2
    Generation: 2
    Generation: 3
    Generation: 3
    Generation: 4
    Generation: 4
    Generation: 5
    Generation: 5
    Generation: 6
    Generation: 6
    Generation: 7
    Generation: 7
    Generation: 8
    Generation: 8
    Generation: 9
    Generation: 9
    Final: Sampled 200 individuals from generation 10
    Final: Sampled 200 individuals from generation 10
    

Data Collection and Storage
---------------------------

.. code:: python

    minor_alleles = np.asarray(af.minor_allele, dtype=np.int8)
    #generations = tuple(map(str, range(0, 11, 2)))

.. code:: python

    print(minor_alleles)


.. parsed-literal::

    [1 2 3 ..., 2 3 1]
    

.. code:: python

    for rep_id, sample_list in meta_populations.items():
        for sample in sample_list:
            sim.stat(sample, alleleFreq=sim.ALL_AVAIL)
            sim.stat(sample, heteroFreq=sim.ALL_AVAIL)
            sim.stat(sample, genoFreq=sim.ALL_AVAIL)

.. code:: python

    artemis_mg = analyze.MultiGeneration('artemis')

.. code:: python

    allele_frequency_data = artemis_mg.collect_allele_frequency_data(meta_populations, minor_alleles)
    gp_data = artemis_mg.collect_genotype_phenotype_data(meta_populations)
    heterozygote_frequency = artemis_mg.collect_heterozygote_frequency_data(meta_populations)
    minor_homozygote_frequency_data = artemis_mg.collect_genotype_frequency_data(meta_populations, minor_alleles)

.. code:: python

    print(allele_frequency_data)


.. parsed-literal::

    [[  0.      0.      0.3   ...,   0.412   0.235   0.242]
     [  0.      2.      0.318 ...,   0.497   0.278   0.302]
     [  0.      4.      0.21  ...,   0.472   0.242   0.247]
     ..., 
     [  1.      6.      0.22  ...,   0.362   0.155   0.142]
     [  1.      8.      0.19  ...,   0.37    0.133   0.122]
     [  1.     10.      0.168 ...,   0.367   0.212   0.212]]
    

.. code:: python

    print(gp_data)


.. parsed-literal::

    [[   107.         0.         0.       121.355     94.086]
     [   119.         0.         0.        95.562     88.397]
     [   135.         0.         0.       105.736    130.704]
     ..., 
     [ 64060.         1.        10.       133.497    123.353]
     [ 64069.         1.        10.       133.259    118.443]
     [ 64102.         1.        10.       132.23     137.926]]
    

.. code:: python

    print(heterozygote_frequency)


.. parsed-literal::

    [[  0.      0.      0.38  ...,   0.465   0.34    0.375]
     [  0.      2.      0.445 ...,   0.505   0.435   0.465]
     [  0.      4.      0.28  ...,   0.505   0.395   0.385]
     ..., 
     [  1.      6.      0.32  ...,   0.455   0.28    0.235]
     [  1.      8.      0.34  ...,   0.46    0.235   0.215]
     [  1.     10.      0.275 ...,   0.465   0.365   0.355]]
    

.. code:: python

    print(minor_homozygote_frequency_data)


.. parsed-literal::

    [[  0.      0.      0.11  ...,   0.18    0.065   0.055]
     [  0.      2.      0.095 ...,   0.245   0.06    0.07 ]
     [  0.      4.      0.07  ...,   0.22    0.045   0.055]
     ..., 
     [  1.      6.      0.06  ...,   0.135   0.015   0.025]
     [  1.      8.      0.02  ...,   0.14    0.015   0.015]
     [  1.     10.      0.03  ...,   0.135   0.03    0.035]]
    

.. code:: python

    np.savetxt('demo_artemis_minor_allele_frequencies.txt', allele_frequency_data, fmt='%.4f', delimiter='\t')
    np.savetxt('demo_artemis_genotype_phenotype_data.txt', gp_data, fmt='%.4f', delimiter='\t')
    np.savetxt('demo_artemis_heterozygote_frequencies.txt', heterozygote_frequency, fmt='%4f', delimiter='\t')
    np.savetxt('demo_artemis_minor_allele_homozygote_frequencies.txt', minor_homozygote_frequency_data, fmt='%.4f', delimiter='\t')

